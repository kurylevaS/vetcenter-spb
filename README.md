# Next.js Project

## Первый запуск

Для успешного запуска необходимо:

- Скопировать `.env.example` в `.env.local` и заполнить переменными по образцу. Значение переменных см. ниже в пункте [Переменные среды](#переменные-среды)
- Установить все зависимости (нужно иметь локально установленный Node.js, используемую версию на этом проекте можно посмотреть в package.json):

```bash
npm i
```

- Далее нужно настроить husky, чтобы коммиты не создавались, если есть ошибки eslint + форматирование кода при каждом коммите
- Для этого нужно поочередно выполнить эти 4 команды

```bash
npx husky-init
git add .husky/pre-commit
chmod ug+x .husky/*
chmod ug+x .git/hooks/*
```

## Запуск для разработки

Для успешного запуска необходимо:

- Скопировать `.env.example` в `.env.local` и заполнить переменными по образцу. Значение переменных см. ниже в пункте [Переменные среды](#переменные-среды)
- Запустить локальный dev сервер

```bash
npm run dev
```

## Билд

- Перед тем как запушить изменения, убедитесь сначала, что проект сбилдился локально и нет ошибок

```bash
npm run build
```

## Деплой

Подробная инструкция по деплою на различные платформы находится в файле [DEPLOYMENT.md](./DEPLOYMENT.md).

**Быстрый старт:**
- **Vercel** (рекомендуется): подключите репозиторий к Vercel, настройте переменные окружения и деплой произойдет автоматически
- **VPS**: используйте PM2 для управления процессом (см. инструкцию)
- **Docker**: используйте готовые `Dockerfile` и `docker-compose.yml`

## Архитектура проекта

[https://feature-sliced.design/docs/get-started](https://feature-sliced.design/docs/get-started)

## Переменные среды

Значения переменных можно узнать у разработчиков, которые уже работают на проекте или если вы начинаете с нуля, то все значения вносите самостоятельно и далее по необходимости делитесь с другими разработчиками лично. Заполненный .env в гит пушить не рекомендуется, в особенности если там есть важные данные, вроде токенов.
При начальной разработке проекта, когда api для интеграции еще не готово, обязательные поля как правило будут пустые и заполняются позже

| Переменная                      | Значение                                                                                                                             | Обязательно |
| ------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------ | ----------- |
| NEXT_PUBLIC_FRONT_BASE_URL      | URL, на котором находится контент (файлы, изображения). Здесь должен быть URL бекенда.                                               | да          |
| NEXT_PUBLIC_FRONT_API_URL       | URL REST API бекенда, формируется по принципу `https://<домен-бекенда>/api`                                                          | да          |
| NEXT_PUBLIC_FRONT_PROXY_API_URL | URL для прокси, например /api/proxy                                                                                                  | да          |
| NEXT_PUBLIC_BASIC_AUTH_LOGIN    | Логин базовой аутентификации для запросов на бекенд. Если бекенд не защищен базовой аутентификацией, можно оставлять пустым.         | нет         |
| NEXT_PUBLIC_BASIC_AUTH_PASSWORD | Пароль базовой аутентификации для запросов на бекенд. Если бекенд не защищен базовой аутентификацией, можно оставлять пустым.        | нет         |
| UNOPTIMIZED_IMAGES              | Нужно ли пропускать оптимизацию изображений. 0 - нет, 1 - да. Оптимизацией изображений занимается бекенд. Значение по умолчанию - 0. | нет         |
| ENABLE_SENTRY                   | Нужно ли включить sentry на проекте, 0 - нет, 1 - да. Данный параметр требует настройки других переменных связанных с sentry         | да          |
| SENTRY_DSN                      | Sentry DSN можно узнать в настройках проекта Sentry                                                                                  | нет         |
| SENTRY_PROJECT                  | Название проекта можно узнать в настройках проекта Sentry                                                                            | нет         |
| SENTRY_AUTH_TOKEN               | Auth token можно создать в настройках организации в Sentry                                                                           | нет         |
| REVALIDATE_SECRET               | Секретный ключ для on-demand revalidation страниц через webhook. Сгенерируйте сложный случайный ключ (например, через `openssl rand -base64 32`). Используется для мгновенного обновления страниц при изменении контента в WordPress. | да (для production) |
| TELEGRAM_BOT_TOKEN              | Токен Telegram бота для отправки уведомлений из формы обратной связи                                                                 | нет         |
| TELEGRAM_CHAT_ID                | ID чата в Telegram для получения уведомлений из формы обратной связи                                                                 | нет         |
